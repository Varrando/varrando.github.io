<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="../../varrando-player/styles/default.css"/>
        <!--<script type="text/javascript" src="//s0.2mdn.net/instream/html5/ima3.js"></script>-->
		<script type="text/javascript" src="https://content.jwplatform.com/libraries/V6NfEzT7.js"></script>
        <script type="text/javascript" src="../../varrando-player/varrandoplayer.min.js"></script>
        <title>Test Companions Priority Demo</title>
        <style type="text/css">
			body {
				padding: 10px;
			}
			.wrapper { 
				border: 2px solid black; 
				display:inline-block; 
				width: 45%;
				min-width: 750px;
				vertical-align:top;
				padding: 10px;
				text-align: center;
			}
			#varrandoPlayer, #jwPlayer {
				margin: 0px auto;
			}
			.companionWrapper { 
				width: 730px; 
				margin-top: 10px;
			}
            .companion {
				border: 1px #dddddd dashed; 
				float:left;
			}
			
        </style>
    </head>
    <body>
		<div id="varrando" class="wrapper">
			<header>Varrando Player</header>
			<div id="varrandoPlayer" class="centered"></div>
			<div class="companionWrapper">
				<!-- leader-board -->
				<div id="slot728x90" style="width: 728px; height:90px;" class="companion"></div>
				<!-- wide skyscraper -->
				<div id="slot160x600" style="width: 160px; height: 600px;" class="companion"></div>
				<!-- medium rectangle -->
				<div id="slot300x250" style="width: 300px; height: 250px;" class="companion"></div>
				<!-- mobile banner -->
				<div id="slot320x50" style="width: 320px; height: 50px;" class="companion"></div> 
			</div>
		</div>
		<div id="jw" class="wrapper">
			<header>JW Player</header>
			<div id="jwPlayer" class="centered"></div>
			<div class="companionWrapper">
				<div class="companion" id="slot1" style="width:728px; height:90px;">&nbsp;</div>
				<div class="companion" id="slot2" style="width:160px; height:600px;">&nbsp;</div>
				<div class="companion" id="slot4" style="width:300px; height:250px;">&nbsp;</div>
				<div class="companion" id="slot3" style="width:320px; height:50px;">&nbsp;</div>
			</div>
		</div>

        <script type="text/javascript">
			window.varrandoPlayer || (window.varrandoPlayer = {});
			window.onload = onLoad;
			//vast tag
			var TAG = "./test_priority/wrapper1.xml";
			
			function onLoad() {
				//Varrando player
				var playerOptions = {
					autoplay: false,
					autoplayNext: true,
					loops: 2,
					volume: 0,
					muted: true,
					width: "500px",
					height: "232px",
					preload: "auto",
					controls: true,
					fullscreen: true,
					share: ['f', 't', 'i'],
					debug: false,
					ga: false,
					playlist: 'https://content.jwplatform.com/feeds/13ShtP5m.rss',
					playerSwf: '../../varrando-player/swf/FlashPlayback.swf',
					playerSwfTimeout: 5000,
					tagId: '123',
					playerId: '123',
				};

				var adsOptions = {
					timeout: 5000,
					postrollTimeout: 3000,
					preload: false,
					preloadPreroll: false,
					debug: true,
					adBreaks: [{
							time: '0',
							tag: {
								url: TAG
							}
						}]
				};
				
				playerOptions.ads = adsOptions;

				var player = varrandoPlayer.setup("varrandoPlayer", playerOptions);
				player.on('ready', function () {
					console.log('HTML Player Ready');
				});
				player.defineSlot('slot728x90', 728, 90);
				player.defineSlot('slot300x250', 300, 250);
				player.defineSlot('slot320x50', 320, 50);
				player.defineSlot('slot160x600', 160, 600);
				
				//JW Player
				var platform = "flash"; 	//html5 || flash
				
				var playerInstance = jwplayer("jwPlayer").setup({
					file: "https://content.jwplatform.com/videos/Wf8BfcSt-kNspJqnJ.mp4",
					image: "https://content.jwplatform.com/thumbs/Wf8BfcSt-640.jpg",
					width: "500",
					height: "232",
					primary: platform,
					autostart: "true",
					mute: "true",
					advertising: { 
						client: "vast",
						schedule: {"myAds":{"offset":"pre","tag":TAG}}
					  }
					});
					
				playerInstance.on('adCompanions', function(event) {
				  for(var i = 0; i < event.companions.length; i++) {
					var entry = event.companions[i];
					if(entry.width == 728) {
					  insertAd("slot1", entry.resource);
					} else if(entry.width == 160) {
					  insertAd("slot2", entry.resource);
					} else if(entry.height == 32) {
					  insertAd("slot3", entry.resource);
					} else if(entry.height == 250) {
					  insertAd("slot4", entry.resource);
					}
				  }
				});

				function insertAd(element,resource) {
				  var div = document.getElementById(element);
				  div.style.backgroundImage = "url("+resource+")";
				  div.style.backgroundRepeat = "no-repeat";
				  div.style.backgroundSize = "cover";
				}
				
				}
        </script>
    </body>
</html>